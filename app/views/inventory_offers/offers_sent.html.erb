<% if flash[:notice].present? %>
  <div id="flash-message-container">
    <div id="flash-message" class="alert alert-lite border border-lite mt-4" role="alert">
      <i class="bi bi-bag-check-fill m-2"></i><%= flash[:notice] %>
    </div>
  </div>
<% end %>

<div class="container-fluid px-4 shadow-lg p-3 mb-5 bg-body-tertiary rounded">
  <h1 class="mt-4">Offers Sent</h1>
  <ol class="breadcrumb mb-4">
    <li class="breadcrumb-item"><%= link_to 'Dashboard', root_path %></li>
    <li class="breadcrumb-item active"><%= link_to 'Inventories', inventories_path %></li>
    <li class="breadcrumb-item active">Offers Sent</li>
  </ol>

  <div class="">
    <div class="card mb-4">
      <div class="card-header">
        <i class="bi bi-cloud-arrow-up-fill me-1"></i>
          Offers Sent
      </div>

      <div class="card-body">
        <table class="table">
          <thead>
            <tr>
              <th scope="col">S.No</th>
              <th scope="col">Inventory</th>
              <th scope="col">Offer</th>
              <th scope="col">Status</th>
              <th scope="col">Date Time</th>
              <th>Requote</th>
            </tr>
          </thead>

          <tbody>
            <% @offers.each_with_index do |offer, index| %>
              <tr>
                <td><%= index + 1 %></td>
                <td><%= offer.inventory.make %></td>
                <td><%= offer.offer %></td>
                <td><%= offer.status || '-' %></td>
                <td><%= offer.created_at.strftime("%d-%b-%Y, %I:%M %p") %></td>
                <td><a href="#" onclick="requote(<%= offer.id %>)" class="btn btn-warning btn-sm ml-1">Requote</a></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>

    <%= paginate @offers %>
  </div>
</div>

<div class="offer_popup"></div>
<script>
   function requote(offer_id){
    $.ajax({
      type: 'GET',
      url: '/inventory_offers/requote.js',
      data: { offer_id: offer_id },
      success: function(response) {
        console.log('Offer created successfully:', response);
      },
      error: function(error) {
        console.error('Error saving message:', error );
      }
    });
  }
</script>
