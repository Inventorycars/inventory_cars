<!DOCTYPE html>
<html>
  <head>
    <title>InventoryCars</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "application", media: 'all', 'data-turbolinks-track' => true %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>
    <style type="text/css">
      .hidden{
        display: none;
      }
    </style>
  </head>

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <body class= " <%= current_user || current_admin ? "sb-nav-fixed" : "sb-nav-fixed sb-sidenav-toggled" %>" >
    <%= render '/shared/admin_navbar'%>
    <% if current_user || current_admin %>
    <%= render '/shared/admin_sidebar'%>
    <% end %>
    <div id="layoutSidenav_content">
    <div class="m-3 mt-5">
      <%= yield %>
    </div>
    <%= render '/shared/footer'%>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"   crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
    var flashMessage = document.getElementById("flash-message");
    if (flashMessage) {
        setTimeout(function() {
            flashMessage.style.display = "none";
        }, 2000);
    }
    // grid view and table view 
    const current_view = localStorage.getItem('current_view') || 'grid';

     document.getElementById('gridView').classList.toggle('hidden', current_view !== 'grid');
     document.getElementById('tableView').classList.toggle('hidden', current_view !== 'table');

      document.getElementById('switchButton').addEventListener('change', function() {
      const new_view = this.checked ? 'table' : 'grid';
      localStorage.setItem('current_view', new_view);
      document.getElementById('gridView').classList.toggle('hidden', new_view !== 'grid');
      document.getElementById('tableView').classList.toggle('hidden', new_view !== 'table');
      document.getElementById('viewLabel').textContent = new_view.charAt(0).toUpperCase() + new_view.slice(1) + ' View';
          });
      });

    const stateSelect = document.getElementById('stateSelect');
    const citySelect = document.getElementById('citySelect');

    stateSelect.addEventListener('change', function() {
        const selectedState = stateSelect.value;
        fetch(`/cities?state=${selectedState}`)
            .then(response => response.json())
            .then(data => {
                citySelect.innerHTML = '';
                data.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
            })
            .catch(error => {
                console.error('Error fetching cities:', error);
            });
    });

    citySelect.addEventListener('change', function() {
        const selectedState = stateSelect.value;
        const selectedCity = citySelect.value;
        fetch(`/pincodes?state=${selectedState}&city=${selectedCity}`)
            .then(response => response.json())
            .then(data => {
                pinSelect.innerHTML = '';
                data.forEach(zip_code => {
                    const option = document.createElement('option');
                    option.value = zip_code;
                    option.textContent = zip_code;
                    pinSelect.appendChild(option);
                });
            })
            .catch(error => {
                console.error('Error fetching cities:', error);
            });
 });
</script>

  </body>
</html>